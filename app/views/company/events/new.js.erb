$.magnificPopup.open({
  items: {
      src: '<%= j render "new" %>',
  },
  removalDelay: 300,
  mainClass: 'my-mfp-zoom-in',
  zoom: {
    enabled: true,
    duration: 300,
    easing: 'ease-in-out',
  },
  callbacks: {
    open: function() {
      $('#addRecurringEvent').click(function(){
        let start = moment($("#event_starts_at").val()).format("MM/DD/YYYY HH:mm");
        let end = moment($("#event_ends_at").val()).format("MM/DD/YYYY HH:mm");
        
        $.magnificPopup.close();
        setTimeout(() => {
          $.ajax({
            url: "<%= new_company_unit_recurring_event_path(@unit) %>",
            data: {
              recurring_event: {
                anchor: moment(start).format("YYYY-MM-DD HH:mm"),
                duration: moment(end).diff(moment(start), 'minutes'),
              },
            },
          })
        }, 300);
      })
    },
    afterClose: function() {
      $(".daterangepicker").remove();
      pickr.destroyAndRemove();
    },
  }
});

$(document).ready(function() {
  registerPopupTubs();
  $('#event_ticket_id').selectpicker();
  pickrInit();
})